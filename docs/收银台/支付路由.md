#### 一、路由作用
对于电商平台或者交易平台而言，为了保障自己交易支付的完整性和成功率，一般会考虑接入多个支付渠道。如何在渠道之间进行切换，保证业务的成功率，同时在已用的渠道中，使用低成本的渠道，就是支付路由存在的价值。

1、渠道切换：能够在当前渠道失败率过高的情况下，平滑的切换到备用渠道，保证业务的连续性，提高业务的成功率。

2、节省成本：在能够支持当前交易的支付渠道中，根据支付成本进行排序，首选最低成本的支付渠道，降低公司的成本。

#### 二、设计路由
##### 1、路由分类
一般分为三种：
1. 人工路由：这种方式适合渠道很少的情况，随着渠道增多，这种方式就不适合了；

2. 规则路由：一般可以通过收集到的条件，进行数据库查询的时候，自行匹配出合适的渠道，并完成优劣选择，这是最常用的方式；

3. 基于权重的路由：这种方式比较复杂，且权重的设置需要不断的尝试，也可能针对不同的场景还要有多套权重设置方案，实操起来并不简单。

##### 2、路由要素
规则路由筛选渠道的要素，可以分为以下三类：
1. 商户侧：商户ID（根据商户的等级、商户行业、商户地域等信息为商户配置渠道之后，在调用路由模块时，只需要上传商户ID即可，如果有共用的渠道可以使用的话，则可能需要上传商户的更多信息）；

2. 业务侧：交易时间、交易金额（单笔、汇总、阶梯）、渠道类型、卡类型、交易银行；

3. 渠道侧：费率（单笔、汇总、阶梯）、营销（优惠、折扣、补贴总金额、活动时间）、渠道等级（稳定性、TPS、掉单率、到账时效）、资金头寸（只在付款的交易中需要考虑）。

##### 3. 路由逻辑
路由在被调用的时候，根据请求参数和筛选出的各渠道的成本排序，完成成本最低的最优渠道选择，并被同一笔订单多次调用的时候，依次返回最优、次优渠道，直到可选渠道全部尝试完毕。