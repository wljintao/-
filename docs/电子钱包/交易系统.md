#### 一、交易系统
交易系统是整个钱包产品中各种支付方式的实现，包括（担保交易、即时到账交易、货到付款交易等）。

#### 二、主要功能
从模块上划分，如下：

![avatar](../../images/交易系统功能.png ':size=700')

**交易前置：** 接受订单支付的请求，包括：订单信息、支付金额、物流方式等信息；

**交易风控：** 根据订单信息和外部信息，判断客户的欺诈性，给出决策；若判断为欺诈，则交易前置返回失败信息，并调用消息通知服务（例如短信），通知客户；

**交易处理：** 判断订单中的交易方式，配置支付渠道。

**收费管理：** 这块暂不讨论。

**超时处理：** 交易系统处理超时后的后续操作。

**消息通知：** 对接邮箱、OA、短信平台，将交易系统中的异常信息抛出，并通过消息平台触达运维人员或其他人员。

#### 三、逻辑流程

![avatar](../../images/交易系统流程.png ':size=700')

1、交易前置接收到订单支付的请求，调用交易风控模块，对支付行为判断是否欺诈、盗刷、洗钱等风险判断，若是则交易系统返回拒绝。

2、风控通过后，交易前置将订单信息发送给交易处理模块，根据订单中的交易方式（担保交易、货到付款、现金交易等），从收费管理模块中，读取交易方式的费用，并记录费用支付流水信息。

3、交易处理模块根据交易方式的不同，对收银台的支付渠道进行分类展示，例如：现金支付，支付渠道只配置微信、支付、银行卡的借记卡类型；信用支付，支付渠道只配置信用卡和贷款的支付。